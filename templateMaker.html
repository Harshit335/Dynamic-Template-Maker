<!DOCTYPE html>
<html lang="en">
<head>
<title>ACE in Action</title>
<style type="text/css" media="screen">
    #editor {
        position: absolute;
        top: 2%;
        right: 0;
        bottom: 0;
        left: 50%;
        width: 50%;
    }
    .drag {
        padding: 10px
    }
    .drag>span {
        padding: 3px;
        display: inline;
        margin: 0 2px;
        border: solid 1px purple;
        cursor: grab;
    }
    #ifInput1{
        display: none;
    }
    #ifInput2{
        display: none;
    }
</style>
</head>
<body>
    <div id="members-div">
        Hello
    </div>
    <div>
        <input type="file" onChange="updateValue()"></input>
    </div>
    <div id="editor">function foo(items) {
        var x = "All this is syntax highlighted";
        return x;
    }</div>
    <br><br><br>
    <div>
        Apply loop on
    </div>
    <input id="loopOn" value="" onchange="loopInputChange()"></input>
    <!-- <button type="button" onclick="loopButtonClick()">Apply Loop</button> -->
    <div class="drag">
        <span draggable=true id="loopStart" ondrop="loopDropped(event)" ondragstart="drag(event)">LOOP_START: </span>
        <span draggable=true id="loopEnd" ondragstart="drag(event)">LOOP_END</span>
    </div>
    <div>
        If Condition
    </div>
    <div>
        <select id="ifCondDrop" onchange="ifCondChange()">
            <option value="AND">AND</option>
            <option value="OR">OR</option>
            <option value="GTE">GTE</option>
            <option value="LTE">LTE</option>
            <option value="GT">GT</option>
            <option value="LT">LT</option>
            <option value="NE">NE</option>
            <option value="EQ">EQ</option>
        </select>
        <input id="ifInput1" value="" onchange="ifInputChange()"></input>
        <input id="ifInput2" value="" onchange="ifInputChange()"></input>
        <!-- <button type="button" id="ifButton" onclick="ifButtonClick()" style="display: none;">Apply If</button> -->
        <div class="drag">
            <span draggable=true id="ifStart" ondragstart="drag(event)">IF: </span>
            <span draggable=true id="ifEnd" ondragstart="drag(event)">IF_END</span>
        </div>
    </div>
    <div>
        <button type="button" onClick="convertButton()">Convert</button>
    </div>
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.7.1/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
        var codeValue = "";
        var editor = ace.edit("editor");
        var ifDrop = document.getElementById("ifCondDrop");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/javascript");

       function loopButtonClick(){
           var inputVal = document.getElementById("loopOn").value;
           var loopStartSpan = document.getElementById("loopStart");
           loopStartSpan.style.display = "inline";
           var loopEndSpan = document.getElementById("loopEnd");
           loopEndSpan.style.display = "inline";
           loopStartSpan.innerHTML = "LOOP_START:" + inputVal;
       }

       function loopInputChange(){
           var inputVal = document.getElementById("loopOn").value;
           var loopStartSpan = document.getElementById("loopStart");
           var loopEndSpan = document.getElementById("loopEnd");
           loopStartSpan.innerHTML = "LOOP_START:" + inputVal;
       }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.innerHTML);
        }

        function ifCondChange(){
            if(ifDrop.options[ifDrop.selectedIndex].text == "NE"){
                document.getElementById("ifInput1").style.display = "inline";
                document.getElementById("ifInput2").style.display = "inline";
            }else{
                document.getElementById("ifInput1").style.display = "none";
                document.getElementById("ifInput2").style.display = "none";
            }
        }

        function ifInputChange(){
           var inputVal1 = document.getElementById("ifInput1").value;
           var inputVal2 = document.getElementById("ifInput2").value;
           var ifStartSpan = document.getElementById("ifStart");
           var ifEndSpan = document.getElementById("ifEnd");
           ifStartSpan.innerHTML = "IF:("+ ifDrop.options[ifDrop.selectedIndex].text + " " + inputVal1 + " " + inputVal2 + ")";
        }
        
        function convertButton(){
            console.log();
        }

        function updateValue(){
            const [file] = document.querySelector('input[type=file]').files;
            const reader = new FileReader();


            reader.addEventListener("load", () => {
            var codeText = reader.result;
            codeValue = codeText;
            editor.setValue(codeValue);
            }, false);

            if (file) {
            reader.readAsText(file);
            }
        }  
    </script>
</body>
</html>